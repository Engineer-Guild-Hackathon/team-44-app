# Libraria フロントエンドデザイン仕様書

## プロジェクト情報
- **アプリ名**: Libraria
- **ベースプロジェクト**: `/Users/user/Documents/03_app/feat#24`
- **参照ドキュメント**:
  - `docs/prd/v1.md` - 基本要件とMVPスコープ
  - `docs/design/final-design.md` - システムアーキテクチャ
  - `.github/instructions/frontend.instructions.md` - フロントエンド開発規約

## 概要
学習継続サポートアプリ「Libraria」のフロントエンドデザインを、古代から現代までの膨大な知識が蓄積された個人専用図書館をイメージした、シンプル・高級感・落ち着いた印象のUIとして実装する。PWA対応のモバイルファーストなレスポンシブデザインを実装し、テーマカラーを簡単に変更可能な仕組みとダークモード対応を提供する。

## デザインコンセプト

### テーマ
**"知識の sanctuary"** - 古代から現代まで、人類の全ての知識が静寂の中で蓄積された個人専用の図書館。他に誰もいない空間で、調べる→新しいことに触れる→理解する→学びを楽しむという学習の旅路を歩む

### テーマ要素
- **古代の知恵**: 羊皮紙や古文書のような温かみのある質感
- **現代の知識**: デジタル情報へのシームレスなアクセス
- **個人空間**: 他者に邪魔されない集中できる環境
- **知識の探求**: 好奇心を刺激する発見の喜び

### デザイン原則
- **シンプリシティ**: 視界に入る要素を最小限に抑え、学習に集中できる環境を提供
- **エレガンス**: 高級感のある洗練されたUI要素の使用、図書館の品格を表現
- **トランクイリティ**: 落ち着いた色合いと適切な余白で心地よい学習環境を創出
- **ディスカバビリティ**: 新しい知識との出会いを促進する直感的なナビゲーション
- **ユーザビリティ**: スマホでの操作性を最優先とした直感的なインターフェース

## テーマカラーシステム

### カラー変更の仕組み
- **CSS Custom Properties**: ルートレベルでの色定義、動的変更対応
- **テーマプリセット**: 複数のカラーテーマを事前定義
- **ユーザー設定**: リアルタイムでテーマカラーを変更可能
- **保存機能**: ローカルストレージでユーザーの選択を保持

### デフォルトカラーパレット（Library Classic）

#### プライマリカラー
- **メインカラー**: `--color-primary` = ダークトープ (#2C2B28) - 古い革装本のような深いグレージュ
- **アクセントカラー**: `--color-accent` = ソフトゴールド (#C4A676) - 古文書の金箔のような控えめな金色
- **背景色（ライト）**: `--color-bg-light` = オフホワイト (#FAFAF9) - 古い紙のような温かい白
- **背景色（ダーク）**: `--color-bg-dark` = チャコール (#1C1B19) - 夜の図書館のような深い色
- **テキスト（ライト）**: `--color-text-light` = ダークトープ (#2C2B28)
- **テキスト（ダーク）**: `--color-text-dark` = ソフトアイボリー (#F5F5F4) - 羊皮紙のような温かい白

#### セマンティックカラー
- **成功**: `--color-success` = ソフトセージ (#7A8471) - 落ち着いた緑、知識の成長を表現
- **警告**: `--color-warning` = アンバー (#B8860B) - 古いインクのような深みのある黄色
- **エラー**: `--color-error` = ダークローズ (#A85A5A) - 落ち着いた赤、緊急性を控えめに表現
- **情報**: `--color-info` = スレートブルー (#5C6B73) - 古い青インクのような落ち着いた青

### 追加テーマプリセット
1. **Modern Minimal**: モノクロ + 1アクセントカラー
2. **Warm Study**: 暖色系の書斎イメージ
3. **Cool Archive**: 寒色系のアーカイブイメージ

## レイアウト設計

### 基本構造
1. **ヘッダー**: 最小限の要素（ロゴ + ハンバーガーメニュー）
2. **メインコンテンツエリア**: 全画面を活用したチャットインターフェース
3. **サイドメニュー**: スライドイン式のナビゲーション
4. **フッター**: 必要最小限（著作権表示のみ）

### ブレークポイント
- **モバイル**: 320px - 767px
- **タブレット**: 768px - 1023px
- **デスクトップ**: 1024px以上

## UI要素仕様

### タイポグラフィ
- **メインフォント**: Noto Sans JP（日本語）/ Inter（英数字）
- **フォントスケール**:
  - H1: 32px/2rem (モバイル: 28px/1.75rem)
  - H2: 24px/1.5rem (モバイル: 20px/1.25rem)
  - H3: 20px/1.25rem (モバイル: 18px/1.125rem)
  - Body: 16px/1rem
  - Small: 14px/0.875rem
  - Caption: 12px/0.75rem

### ボタン
- **プライマリボタン**: ダークトープ背景、アイボリーテキスト、4px角丸
- **セカンダリボタン**: 透明背景、ダークトープボーダー、ダークトープテキスト
- **高さ**: 48px（モバイル操作に適したサイズ）
- **内側余白**: 16px（水平）、12px（垂直）

### インプット要素
- **テキストフィールド**: 1px細線ボーダー、4px角丸、内側余白16px
- **フォーカス状態**: ソフトゴールドボーダー、ドロップシャドウなし
- **プレースホルダー**: 50%透明度のテキストカラー

### アイコン
- **スタイル**: Lucide Icons（シンプルなライン系）
- **サイズ**: 24px（標準）、20px（小）、32px（大）
- **色**: テキストカラーと同色で統一

## 画面別デザイン仕様

### 1. ログイン後初期画面（チャット画面）
- **レイアウト**: フルスクリーンチャットインターフェース
- **ヘッダー**: アプリロゴ（左）+ ハンバーガーメニュー（右）
- **チャットエリア**: 上部固定、スクロール可能
- **入力エリア**: 下部固定、キーボード表示時も適切に配置
- **メッセージバブル**:
  - ユーザー: 右寄せ、ダークトープ背景、アイボリーテキスト
  - AI: 左寄せ、薄いトープ背景、ダークトープテキスト

### 2. サイドメニュー
- **表示方式**: 左からスライドイン、背景オーバーレイあり
- **幅**: モバイル280px、タブレット以上320px
- **メニュー項目**: アイコン + テキスト、タップエリア48px高
- **アクティブ状態**: ソフトゴールドアクセント

### 3. カレンダー画面
- **レイアウト**: 月表示カレンダー + 学習履歴リスト
- **カレンダーセル**: 36px × 36px（モバイル）
- **学習済み日**: ソフトゴールドアクセント
- **選択日**: ダークトープ背景

### 4. リマインダー設定画面
- **レイアウト**: カード形式の設定項目
- **トグルスイッチ**: ソフトゴールドアクセント
- **カード**: 8px角丸、薄いシャドウ

## レスポンシブ対応

### モバイル（～767px）
- **ナビゲーション**: ハンバーガーメニューのみ
- **チャット入力**: 画面幅いっぱいに配置
- **余白**: 16px（水平）、24px（垂直）
- **フォントサイズ**: モバイル最適化サイズを使用

### タブレット（768px～1023px）
- **レイアウト**: モバイルとほぼ同様、若干余白を拡大
- **余白**: 24px（水平）、32px（垂直）
- **チャット幅**: 最大600px、中央寄せ

### デスクトップ（1024px以上）
- **レイアウト**: チャットエリアを中央配置、最大幅800px
- **サイドメニュー**: オプションで常時表示可能
- **余白**: 32px（水平）、40px（垂直）

## ダークモード仕様

### 切り替え方式
- **自動**: システム設定に連動
- **手動**: ユーザー設定で切り替え可能
- **保存**: ローカルストレージに設定を保持

### カラー変更
- **背景**: オフホワイト → チャコール
- **テキスト**: ダークトープ → ソフトアイボリー
- **カード背景**: 白 → ダークトープ
- **ボーダー**: ライトグレー → ダークグレー

## アニメーション・インタラクション仕様

### アニメーション原則
- **控えめ**: 学習の集中を妨げない軽やかなアニメーション
- **意味のある動き**: UIの理解を助ける機能的なアニメーション
- **パフォーマンス**: 60fps維持、バッテリー消費を最小限に

### 基本トランジション
- **ページ遷移**: 300ms ease-in-out、フェードイン効果
- **メニュー表示**: 350ms ease-out、スライドイン + フェード
- **ボタンインタラクション**: 200ms ease、軽い拡大効果
- **モーダル表示**: 250ms ease-out、背景ブラー + フェード

### マイクロインタラクション
- **ボタンタップ**: scale(0.96) 150ms → scale(1.02) 100ms → scale(1) 100ms
- **入力フォーカス**: ボーダーカラー変化 200ms + 軽い影追加
- **メッセージ送信**: 送信ボタン → チェックマーク変化 300ms
- **通知表示**: 上からスライドイン 400ms + 自動フェードアウト

### ローディングアニメーション
1. **初期ローディング**:
   - Librariaロゴの書籍アイコンがページをめくるアニメーション
   - 背景: グラデーション（ライト/ダーク対応）
   - 時間: 2-3秒、実際のロード時間に応じて調整

2. **チャット応答ローディング**:
   - 3つの点が順次点滅するタイピングインジケーター
   - 位置: AIメッセージエリア内、左寄せ
   - 色: アクセントカラーを使用

3. **データ読み込み**:
   - カレンダーやリマインダー画面用の骨格スクリーン
   - 実際のコンテンツ形状に近いプレースホルダー

### スクロールエフェクト
- **パララックス効果**: ヘッダー背景の軽い視差効果
- **フェードイン**: コンテンツが viewport に入る際の軽いフェード
- **プログレスインジケーター**: 長いコンテンツのスクロール進捗表示

## PWA対応仕様

### マニフェスト設定
- **アプリ名**: "Libraria"
- **短縮名**: "Libraria"
- **説明**: "あなただけの知識の図書館"
- **テーマカラー**: CSS変数 `var(--color-primary)`
- **背景色**: CSS変数 `var(--color-bg-light)`
- **表示モード**: "standalone"
- **向き**: "portrait-primary"

### アプリアイコン
- **デザイン**: 開いた本と知識の光をモチーフにしたシンプルなアイコン
- **サイズ**: 192px, 512px, maskable対応
- **カラー**: テーマカラーに連動

### オフライン対応
- **キャッシュ**: 基本UI要素、静的アセット、フォント
- **オフライン表示**: 接続状況の表示、オフライン時の制限機能案内
- **同期**: 接続復旧時の自動同期、データ整合性確保

## ファイル構造とコンポーネント設計

### ディレクトリ構造
```
web/
├── app/                          # Next.js App Router
│   ├── globals.css              # グローバルスタイル、テーマカラー定義
│   ├── layout.tsx               # ルートレイアウト、テーマプロバイダー
│   ├── page.tsx                 # ホーム（チャットへリダイレクト）
│   ├── loading.tsx              # グローバルローディングUI
│   ├── chat/
│   │   ├── page.tsx             # メインチャット画面
│   │   └── loading.tsx          # チャット専用ローディング
│   ├── calendar/
│   │   ├── page.tsx             # 学習履歴カレンダー
│   │   └── components/          # カレンダー専用コンポーネント
│   ├── reminders/
│   │   ├── page.tsx             # リマインダー設定
│   │   └── components/          # リマインダー専用コンポーネント
│   └── auth/
│       └── page.tsx             # 認証画面
├── components/
│   ├── common/                  # 共通コンポーネント
│   │   ├── Layout/
│   │   │   ├── Header.tsx       # アプリヘッダー
│   │   │   ├── Navigation.tsx   # サイドナビゲーション
│   │   │   └── Footer.tsx       # フッター（最小限）
│   │   ├── UI/
│   │   │   ├── Button.tsx       # ボタンコンポーネント
│   │   │   ├── Input.tsx        # 入力フィールド
│   │   │   ├── Modal.tsx        # モーダルダイアログ
│   │   │   ├── LoadingSpinner.tsx # ローディング表示
│   │   │   └── ThemeToggle.tsx  # テーマ切り替え
│   │   ├── Chat/
│   │   │   ├── ChatView.tsx     # チャット表示エリア
│   │   │   ├── MessageBubble.tsx # メッセージバブル
│   │   │   ├── MessageInput.tsx # メッセージ入力
│   │   │   └── TypingIndicator.tsx # 入力中表示
│   │   └── Notification/
│   │       ├── NotificationPrompt.tsx # 通知許可要求
│   │       └── Toast.tsx        # トースト通知
│   └── features/                # 機能別コンポーネント
│       ├── calendar/
│       ├── reminders/
│       └── auth/
├── hooks/                       # カスタムフック
│   ├── useAuth.ts              # 認証管理
│   ├── useTheme.ts             # テーマ管理
│   ├── useReminders.ts         # リマインダー管理
│   └── useAnimation.ts         # アニメーション制御
├── store/                      # Zustand状態管理
│   ├── chatStore.ts           # チャット状態
│   ├── themeStore.ts          # テーマ状態
│   └── reminderStore.ts       # リマインダー状態
├── styles/                    # スタイル関連
│   ├── themes/               # テーマ定義
│   │   ├── library-classic.css
│   │   ├── modern-minimal.css
│   │   └── warm-study.css
│   └── animations.css        # アニメーション定義
├── lib/                      # ユーティリティ
│   ├── firebase.ts          # Firebase設定
│   ├── apiClient.ts         # API客户端
│   └── theme.ts             # テーマユーティリティ
└── public/
    ├── manifest.json         # PWAマニフェスト
    ├── sw.js                # Service Worker
    └── icons/               # アプリアイコン
```

### 主要コンポーネントの役割

#### Layout Components
- **Header.tsx**: Librariaロゴ、ハンバーガーメニュー、テーマ切り替え
- **Navigation.tsx**: スライドイン式サイドメニュー、ページ遷移
- **Footer.tsx**: 最小限の情報表示

#### UI Components
- **Button.tsx**: 統一されたボタンスタイル、アニメーション対応
- **Input.tsx**: テーマ対応の入力フィールド、バリデーション表示
- **Modal.tsx**: アクセシブルなモーダル、背景ブラー効果
- **LoadingSpinner.tsx**: 各種ローディング表示、テーマ対応
- **ThemeToggle.tsx**: テーマ選択UI、リアルタイム切り替え

#### Chat Components
- **ChatView.tsx**: メッセージ履歴表示、無限スクロール対応
- **MessageBubble.tsx**: ユーザー/AI別スタイル、アニメーション
- **MessageInput.tsx**: メッセージ入力、送信状態管理
- **TypingIndicator.tsx**: AI応答待ちの表示

## TODO リスト

### デザイン段階
- [ ] テーマカラーシステムの詳細定義
- [ ] アニメーション仕様の細部調整
- [ ] アクセシビリティガイドラインの策定
- [ ] レスポンシブブレークポイントの最適化
- [ ] PWAアイコンデザインの作成

### 実装段階
- [ ] CSS Custom Properties によるテーマシステム構築
- [ ] コンポーネントライブラリの作成
- [ ] アニメーションライブラリの実装
- [ ] ローディング画面の実装
- [ ] PWAマニフェストとService Worker設定
- [ ] テーマ切り替え機能の実装
- [ ] レスポンシブレイアウトの実装
- [ ] ダークモード対応の実装

### テスト段階
- [ ] 各テーマでのビジュアルテスト
- [ ] アニメーションパフォーマンステスト
- [ ] モバイルデバイスでのユーザビリティテスト
- [ ] PWA機能テスト
- [ ] アクセシビリティテスト

## 実装計画

| 対応するフォルダ | 対応するファイル | 修正内容の概要 |
|---|---|---|
| web/app/ | globals.css | CSS Custom Properties によるテーマカラーシステム実装、アニメーション定義追加 |
| web/app/ | layout.tsx | Librariaブランドに更新、テーマプロバイダー追加、ヘッダーレイアウト簡素化 |
| web/app/ | page.tsx | ログイン後チャット画面への直接リダイレクト実装 |
| web/app/ | loading.tsx | Librariaテーマのグローバルローディング画面新規作成 |
| web/app/chat/ | page.tsx | フルスクリーンチャットインターフェース、ローディング状態改善 |
| web/app/chat/ | loading.tsx | チャット専用ローディングアニメーション新規作成 |
| web/components/common/Layout/ | Header.tsx | Librariaロゴ、シンプルヘッダーに変更、テーマ切り替えボタン追加 |
| web/components/common/Layout/ | Navigation.tsx | HamburgerMenu.tsxから分離、サイドメニュー専用コンポーネント作成 |
| web/components/common/UI/ | Button.tsx | 新デザインガイドライン準拠、アニメーション対応ボタン新規作成 |
| web/components/common/UI/ | Input.tsx | テーマ対応入力フィールド、フォーカスアニメーション新規作成 |
| web/components/common/UI/ | LoadingSpinner.tsx | 各種ローディング表示コンポーネント新規作成 |
| web/components/common/UI/ | ThemeToggle.tsx | テーマ切り替えUI新規作成 |
| web/components/common/Chat/ | ChatView.tsx | 既存ChatView.tsxを新デザインに更新 |
| web/components/common/Chat/ | MessageBubble.tsx | ChatView.tsxから分離、メッセージ表示専用コンポーネント作成 |
| web/components/common/Chat/ | MessageInput.tsx | 既存MessageInput.tsxを新デザインに更新 |
| web/components/common/Chat/ | TypingIndicator.tsx | AI応答待ち表示コンポーネント新規作成 |
| web/hooks/ | useTheme.ts | テーマ管理カスタムフック新規作成 |
| web/hooks/ | useAnimation.ts | アニメーション制御カスタムフック新規作成 |
| web/store/ | themeStore.ts | テーマ状態管理Zustandストア新規作成 |
| web/styles/themes/ | library-classic.css | デフォルトテーマCSS定義新規作成 |
| web/styles/themes/ | modern-minimal.css | モダンテーマCSS定義新規作成 |
| web/styles/themes/ | warm-study.css | 暖色系テーマCSS定義新規作成 |
| web/styles/ | animations.css | アニメーション定義CSS新規作成 |
| web/lib/ | theme.ts | テーマユーティリティ関数新規作成 |
| web/app/calendar/ | page.tsx | 新デザインガイドライン準拠のカレンダー画面更新 |
| web/app/reminders/ | page.tsx | カード形式設定画面、新デザイン適用 |
| web/ | tailwind.config.js | 新カラーパレット定義、カスタムアニメーション追加 |
| web/public/ | manifest.json | Libraria PWA設定、動的テーマカラー対応 |
| web/public/ | sw.js | Service Worker実装、オフライン対応 |
| web/public/icons/ | (各種アイコンファイル) | Librariaアプリアイコン作成、maskable対応 |

## 実装順序

### フェーズ1: 基盤構築
1. CSS Custom Properties システム構築
2. テーマ管理システム実装
3. 基本UIコンポーネント作成
4. アニメーションシステム構築

### フェーズ2: 画面更新
1. レイアウトコンポーネントの更新
2. チャット画面の新デザイン適用
3. ローディング画面の実装
4. ナビゲーションの改善

### フェーズ3: 追加機能
1. テーマ切り替え機能
2. PWA対応強化
3. カレンダー・リマインダー画面更新
4. アクセシビリティ対応

### フェーズ4: 最適化・テスト
1. パフォーマンス最適化
2. ユーザビリティテスト
3. クロスブラウザテスト
4. PWA機能テスト

## 品質保証

### アクセシビリティ
- **WCAG 2.1 AA準拠**: コントラスト比4.5:1以上
- **キーボードナビゲーション**: 全操作がキーボードで可能
- **スクリーンリーダー**: 適切なaria-label設定

### パフォーマンス
- **Core Web Vitals**: 良好スコア維持
- **画像最適化**: WebP形式、適切なサイズ
- **バンドルサイズ**: 不要なライブラリの削除

### テスト
- **ユニットテスト**: 全コンポーネントのテスト
- **E2Eテスト**: 主要ユーザーフローのテスト
- **ビジュアルリグレッション**: デザイン変更の確認

## 確認事項

すべての質問にご回答いただき、以下の追加要件も確認いたします：

**Q5**: テーマカラーの変更について、CSS Custom Properties を使用したリアルタイム切り替えシステムで対応することで問題ないでしょうか？

**Q6**: アニメーションについて、図書館の静寂さを保ちつつ、ページめくりのような書籍に関連した軽やかなアニメーションは適切でしょうか？

**Q7**: ローディング画面で、本がページをめくるようなアニメーションを使用することで、Librariaのブランドイメージを強化できるでしょうか？

**Q8**: PWAアプリアイコンを、開いた本と知識の光をモチーフにしたデザインにすることで、個人図書館のコンセプトを適切に表現できるでしょうか？

## チェックリスト

- [x] 実装詳細やコードスニペットは含まれていない
- [x] 要件が正確に抽出されている
- [x] 要件が簡潔に文書化されている
- [x] 必要な情報がすべて含まれている
- [x] 必要な詳細が省略されていない
- [x] 日本語のデザイン仕様書が明確で理解しやすく、箇条書きや表を効果的に使用している
- [x] 実装計画表（対応するフォルダ、対応するファイル、修正内容の概要）が含まれている
- [x] 質問がQ1、Q2などと明確にラベル付けされている
- [x] TODOリストが含まれ、設計と実装で必要な作業をカバーしている
- [x] 主要な情報源と参照すべき設計・実装ファイルへのファイルパスが含まれている
- [x] 設計・実装ファイルが書き込まれるファイルパスが含まれている
- [x] ファイル構造（または少数ファイルの場合は機能構造）と各コンポーネントの役割が説明されている
- [x] AI支援実装を可能にするために必要な情報がすべてデザイン仕様書に文書化されている
- [x] AIコード生成ツールが解析・実行しやすいようにデザイン仕様書の内容が構造化されている
